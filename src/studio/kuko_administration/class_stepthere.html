<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="css/commer.css" />
<link rel="stylesheet" type="text/css" href="css/main.css" />
<link rel="stylesheet" href="css/style.css">
<script src="js/jquery-1.9.1.min.js" type="text/javascript"></script>
<title>kuko班级管理</title>
</head>

<body>
	<div class="main">     
        <div class="content clearfix">
        	<div class="w_left">
            	<div class="lift">
                	<h3><a href="javascript:;"><img src="images/index/user.png" width="79" height="79" /></a></h3>
                	<ul>
                    	<li><a class="home" href="index.html">首页</a></li>
                        <li><a class="xun" href="xuntang.html">我要巡堂</a></li>
                        <li><a class="culum" href="curriculum.html">课程管理</a></li>
                        <li><a class="teach" href="teacher.html">教师管理</a></li>
                        <li class="selected"><a class="ban" href="javascript:;">班级管理</a></li>
                        <li><a class="timetable" href="row_stepfirst.html">排课管理</a></li>
                        <li><a class="analysis" href="analysis.html">教学分析</a></li>
                        <li><a class="member" href="u_membercenter.html">个人中心(<span>4</span>)</a></li>
                        <li><a class="help" href="javascript:;">使用帮助</a></li>
                    </ul>
                    <h4><a href="javascript:;"><img src="images/index/feedback.png" width="156" height="70" /></a></h4>
                </div>
            </div>
            <div class="w_right">
            	<div class="all">
                	<div class="course clearfix">
                		<h2>班级管理</h2>  
                    </div>
                   	<div class="class_step">
                    	<img src="images/jiaowu/class_step3.png" width="773" height="38" />
                    </div>
                    <div class="stepthere">
                    	<div class="there_main">
                            <table>
                                <tr>
                                    <th style=" width:30px;"></th>
                                    <th style=" width:70px;">班级</th>
                                    <th style=" width:110px;">班主任</th>
                                    <th style=" width:110px;">开设课程</th>
                                    <th style=" width:210px;">授课老师</th>
                                    <th style=" width:70px;">已选择</th>
                                    <th style=" width:140px;">分配学生</th>
                                </tr>
                                <tr>
                                    <td class="there_grade"><div class="shu">高三年级</div></td>
                                    <td>一班</td>
                                    <td>长孙无忌</td>
                                    <td class="kaishe">
                                        语文、数学、英语
                                        化学、物理、生物
                                        历史、政治、地理
                                    </td>
                                    <td class="shouke">
                                        张三三、张三三、张三三、张三三
                                        张三三、张三三、张三三、张三三
                                        张三三
                                    </td>
                                    <td>40</td>
                                    <td>
                                        <a class="choice-student" href="javascript:;">选择学生</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="there_grade"><div class="shu"></div></td>
                                    <td>二班</td>
                                    <td>长孙无忌</td>
                                    <td class="kaishe">
                                        语文、数学、英语
                                        化学、物理、生物
                                        历史、政治、地理
                                    </td>
                                    <td class="shouke">
                                        张三三、张三三、张三三、张三三
                                        张三三、张三三、张三三、张三三
                                        张三三
                                    </td>
                                    <td>40</td>
                                    <td>
                                        <a class="choice-student" href="javascript:;">选择学生</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="there_grade" style=" border-bottom:1px solid #666666;"><div class="shu"></div></td>
                                    <td style=" border-bottom:1px solid #666666;">三班</td>
                                    <td style=" border-bottom:1px solid #666666;">长孙无忌</td>
                                    <td class="kaishe" style=" border-bottom:1px solid #666666;">
                                        语文、数学、英语
                                        化学、物理、生物
                                        历史、政治、地理
                                    </td>
                                    <td class="shouke" style=" border-bottom:1px solid #666666;">
                                        张三三、张三三、张三三、张三三
                                        张三三、张三三、张三三、张三三
                                        张三三
                                    </td>
                                    <td style=" border-bottom:1px solid #666666;">40</td>
                                    <td style=" border-bottom:1px solid #666666;">
                                        <a class="choice-student" href="javascript:;">选择学生</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="there_grade"><div class="shu">高二年级</div></td>
                                    <td>一班</td>
                                    <td>长孙无忌</td>
                                    <td class="kaishe">
                                        语文、数学、英语
                                        化学、物理、生物
                                        历史、政治、地理
                                    </td>
                                    <td class="shouke">
                                        张三三、张三三、张三三、张三三
                                        张三三、张三三、张三三、张三三
                                        张三三
                                    </td>
                                    <td>40</td>
                                    <td>
                                        <a class="choice-student" href="javascript:;">选择学生</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="there_grade"><div class="shu"></div></td>
                                    <td>二班</td>
                                    <td>长孙无忌</td>
                                    <td class="kaishe">
                                        语文、数学、英语
                                        化学、物理、生物
                                        历史、政治、地理
                                    </td>
                                    <td class="shouke">
                                        张三三、张三三、张三三、张三三
                                        张三三、张三三、张三三、张三三
                                        张三三
                                    </td>
                                    <td>40</td>
                                    <td>
                                        <a class="choice-student" href="javascript:;">选择学生</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="second_btn">
                        	<a class="second_pre" href="class_stepsecond.html">上一步</a>
                            <a class="second_next" href="class_stepfour.html">下一步</a>
                            <span>尚有班级未完成设置</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="dialog" id="dialog">
                <div class="title">
                    <button class="close fr">×</button>
                    选择学生
                </div>
            
                <div class="dialogContent"></div><!-- dialogContent end -->
            </div>
            
        </div>
    </div>
<script type="text/javascript">
function showDialog(outWrap) { var oWin = $(".content"), outWrap = $(outWrap), viewW = oWin.width(), viewH = oWin.height(), sclT = oWin.scrollTop(), sclL = oWin.scrollLeft(), curW = outWrap.width(), curH = outWrap.height(), left = sclL + (viewW - curW) / 2, top = sclT + (viewH - curH) / 2; outWrap.css({ 'left': left, 'top': top }); }; function resize(outWrap) { $(window).resize(function () { if (!$(outWrap).is(':visible')) { return; } else { showDialog(outWrap); } }); }; function closeDialog(oEle, outWrap, oMask) { $(oEle).click(function () { $(outWrap).hide(); $(oMask).hide(); }); }; function initDialog(outWrap, oClose, oMask) { var outWrap = $(outWrap), oClose = $(oClose), oMask = $(oMask); oMask.show(); outWrap.show(); showDialog(outWrap); resize(outWrap); closeDialog(oClose, outWrap, oMask); };

$('.choice-student').click(function(){
	var template ='<p class="curStudent">选中的学生：<span class="num">0</span>/6</p>'+
			'<div class="filter mrgB20" id="filter">'+
				'<label for="checkAll"><input type="checkbox" class="fmCheckbox mrgR10" id="checkAll">全选</label>'+
				'<div class="year dropDown inline-block">'+
					'<span class="name">入学年份</span><span class="arrow"></span>'+
					'<ul class="downList">'+
						'<li><a href="javascript:;">2015</a></li>'+
						'<li><a href="javascript:;">2014</a></li>'+
						'<li><a href="javascript:;">2013</a></li>'+
						'<li><a href="javascript:;">2012</a></li>'+
					'</ul>'+
				'</div>'+
				'<div class="graded dropDown inline-block">'+
					'<span class="name">班级</span><span class="arrow"></span>'+
					'<ul class="downList">'+
						'<li><a href="javascript:;">1班</a></li>'+
						'<li><a href="javascript:;">2班</a></li>'+
						'<li><a href="javascript:;">3班</a></li>'+
						'<li><a href="javascript:;">4班</a></li>'+
					'</ul></div>'+
				'<input type="text" class="fmText"><input type="button" class="fmBtn mrgR5 mrgL5" value="搜索">'+

				'<a href="javascript:;" class="clearFilter" id="clearFilter">清空搜索条件</a>'+
			'</div>'+

			'<div class="gradeLists mrgB20" id="gradeLists">'+
				'<div class="item">'+
					'<input type="checkbox" class="fmCheckbox gradecheckbox mrgR10"><p class="fmLabel inline-block"><span class="inner inline-block mrgR5"><span class="arrow"></span></span>高二2班  (<b class="num">0</b>/3)</p>'+
					'<ul class="slideDown">'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
					'</ul>'+
				'</div>'+
				'<div class="item">'+
					'<input type="checkbox" class="fmCheckbox gradecheckbox mrgR10"><p class="fmLabel inline-block"><span class="inner inline-block mrgR5"><span class="arrow"></span></span>高二2班  (<b class="num">0</b>/3)</p>'+
					'<ul class="slideDown">'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
					'</ul>'+
				'</div>'+
				'<div class="item">'+
					'<input type="checkbox" class="fmCheckbox gradecheckbox mrgR10"><p class="fmLabel inline-block"><span class="inner inline-block mrgR5"><span class="arrow"></span></span>高二2班  (<b class="num">0</b>/3)</p>'+
					'<ul class="slideDown">'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
						'<li><input type="checkbox" class="fmCheckbox mrgR10"> 123456789001 王晓明 高二3班 2013</li>'+
					'</ul>'+
				'</div>'+
			'</div>'+
			
			'<div class="btnBox"><a href="javascript:;" class="btn submit inline-block">确认</a><a href="javascript:;" class="btn cancel-qu inline-block">取消</a></div>';

	$('#dialog div.dialogContent').html(template);
	initDialog('#dialog', '#dialog .close');
});

$('#dialog').delegate('#filter .dropDown','click',function(e){
	e.stopPropagation();
	var downList = $(this).find('.downList');
	$(this).siblings('.dropDown').find('.downList').hide();
	if(downList.is(':hidden')){
		downList.slideDown();
	}else{
		downList.slideUp();
	}
});

$('#dialog').delegate('#filter .dropDown .downList a','click',function(){
	$(this).parents('.dropDown').find('.name').text($(this).text());
});
$(document).click(function(){
	$('#filter .dropDown .downList').hide();
});

$('#dialog').delegate('.gradeLists .fmLabel','click',function(){
	var slideDown=$(this).parent().find('ul.slideDown'),arrow=$(this).find('.inner');
	if(slideDown.is(':hidden')){
		slideDown.show();
		arrow.addClass('innerDown');
	}else{
		slideDown.hide();
		arrow.removeClass('innerDown');
	}
});
$('#dialog').delegate('.gradeLists input.gradecheckbox','click',function(){
	var elem = $(this).parent().find('.slideDown input[type="checkbox"]'),
		curNum=$(this).next().find('b.num'),
		curStudent=$('.curStudent').find('span.num'),
		numLen = parseInt(curNum.text()),
		curAllLen=parseInt(curStudent.text());
	


	if($(this).prop('checked') == false){
		elem.prop('checked',false);
		var curNumLen=parseInt(curNum.text());
		curStudent.text(curAllLen-curNumLen);
		curNum.text(0);		
	}else{
		elem.prop('checked',true);
		curNum.text(elem.length);
		var curNumLen=parseInt(curNum.text());
		curStudent.text(curAllLen+curNumLen);
	};
	$(this).parents('.gradeLists').each(function(){
		curStudent.text($(this).find('input[type="checkbox"]:checked').not('input.gradecheckbox').length)
	});
});

$('#dialog').delegate('.gradeLists li input[type="checkbox"]','click',function(){
	var elemNum=$(this).parents('div.item').find('b.num'),
		curStudent=$('.curStudent').find('span.num'),
		numLen=parseInt(elemNum.text()),
		curAllLen=parseInt(curStudent.text());
	if($(this).prop('checked') == false){
		elemNum.text(numLen-1);
		curStudent.text(curAllLen-1);
	}else{
		elemNum.text(numLen+1);
		curStudent.text(curAllLen+1);
	}

});

$('#dialog').delegate('#checkAll','click',function(){
	var elemPar= $(this).parent().parent().next(),
		checkbox = elemPar.find('input[type="checkbox"]'),
		curStudent=$('.curStudent').find('span.num'),
		gradecheckbox=elemPar.find('.gradecheckbox'),
		curAllLen=parseInt(curStudent.text());
		var classLen;
	if($('.gradeLists input[type="checkbox"]').prop('checked') == false){
		$(this).prop('checked',true);
	}else{
		$(this).prop('checked',false);
	};	
	if(checkbox.prop('checked') == false){
		checkbox.prop('checked',true);
		curStudent.text(curAllLen+(checkbox.length-gradecheckbox.length));
		$('div.item .slideDown').each(function(){
			classLen=$(this).find('input[type="checkbox"]').length;
			$(this).parents('div.item').find('b.num').text(classLen);
		});
	}else{
		checkbox.prop('checked',false);
		curStudent.text(0);
		$('.gradeLists b.num').text(0);
	}
});

$('#dialog').delegate('#clearFilter','click',function(){
	var elemParent = $(this).parent();
	elemParent.find('div.year span.name').text('入学年份');
	elemParent.find('div.grade span.name').text('班级');
	elemParent.find('.fmText').val('');
});
$(decument).on('click', '.btnBox a.submit', function () {
	$("#dialog").hide();
});
</script>
</body>
</html>
